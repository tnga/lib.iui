/*-----------------------------------*\

  $TOAST-GRID

  An insane grid.
  You'd be mad to use it.

  Usage
  =====

  Assuming default values:

  <div class="grid">
    <div class="grid__col grid__col--1-of-2">
      A half-width column.
    </div>
    <div class="grid__col grid__col--1-of-4 grid__col--pull-1-of-4">
      A quarter, pulled left by its own width. You get this, right?
    </div>
  </div>


  Customisation
  =============

  $toast-grid-namespace and $toast-grid-column-namespace
  adjusts the class names for the grid. With
  default values, grid wrappers have a class
  of '.grid' and columns '.grid__col'.

  $toast-col-groups(n) adjusts column divisions.
  For example, $toast-col-groups(12) will produce
  a 12-column grid. $col-groups(3,6,8)
  will produce a 3-, 6-, and 8-column grid.

  $toast-gutter-width is—you guessed it—the gutter
  width. Accepts any unit.

  That's it. Have fun.

\*-----------------------------------*/

// Namespaces
// This stops me from being overzealous with enforcing classes
$toast-grid-namespace: "grid" !default;
$toast-grid-column-namespace: "grid__col" !default;
$toast-grid-column-prefixe: $toast-grid-column-namespace !default;

// $col-groups are the column groups you want
// For example, $col-groups: (3, 4, 5) will output:
// .grid__col--n-of-3, .grid__col--n-of-4, [...]
$toast-col-groups: (2, 3, 4, 5, 6, 8, 12) !default;

// Gutter width
$toast-gutter-width: 20px !default;

$toast-gcs: 1/100 !default; //$toast-gutter-column-size so that it's take in [0,1]

// Breakpoints
$toast-breakpoint-min: 320px !default ;
$toast-breakpoint-smaller: 420px !default ;
$toast-breakpoint-small: 640px !default ;
$toast-breakpoint-medium: 800px !default ;
$toast-breakpoint-normal: 1024px !default ;
$toast-breakpoint-big: 1360px !default ;

// Pushes and pulls
$toast-pushes: true !default;
$toast-pulls: true !default;

.#{$toast-grid-namespace} {
  
  list-style: none;
  margin-left: $toast-gutter-width;
  margin-right: $toast-gutter-width;
}

/* grid's columns are simply set by this way:
* grid-col-virtual-width = grid-col-margin-left + grid-col-margin-right + grid-col(box-sized)-real-width.
*=> grid-col-virtual-width = 2*grid-col-margin-right + grid-col(box-sized)-real-width   (considering: grid-col-margin-left = grid-col-margin-right )
*then: grid-col(box-sized)-real-width = grid-col-virtual-width - 2*grid-col-margin-right
*(grid-col-margin-right and grid-col-margin-left can be considering as column's gutter)
*
*this is the theory and in the practice, it work approximatively well in opera-browser( tested on 12.16),
*but get easly breaking issue on all tested recents browsers (firefox, webkits like browsers).
*so some way find to avoid that is to provide precision control.
*then when set column margin-right and margin-left, take it away a precise value depending of parent column width.
*/
//get the column's gutter size with a precision (for approximation).
//`precision`, cause theory seems sometime to not exactly match with pratice :(.
@function toast-alpha-margin ($precision:0) {
  
  @return  percentage($toast-gcs) - $precision ;
}

%span-all       { width: percentage(1/1) - 2*toast-alpha-margin() ; }

%one-half       { width: percentage(1/2) - 2*toast-alpha-margin() ; }

%one-third      { width: percentage(1/3) - 2*toast-alpha-margin() ; }
%two-thirds     { width: percentage(2/3) - 2*toast-alpha-margin() ; }

%one-quarter    { width: percentage(1/4) - 2*toast-alpha-margin() ; }
%two-quarters   { width: percentage(2/4) - 2*toast-alpha-margin() ; }
%three-quarters { width: percentage(3/4) - 2*toast-alpha-margin() ; }

%push-span-all       { margin-left: percentage(1/1) - toast-alpha-margin() ; }

%push-one-half       { margin-left: percentage(1/2) - toast-alpha-margin() ; }

%push-one-third      { margin-left: percentage(1/3) - toast-alpha-margin() ; }
%push-two-thirds     { margin-left: percentage(2/3) - toast-alpha-margin() ; }

%push-one-quarter    { margin-left: percentage(1/4) - toast-alpha-margin() ; }
%push-two-quarters   { margin-left: percentage(2/4) - toast-alpha-margin() ; }
%push-three-quarters { margin-left: percentage(3/4) - toast-alpha-margin() ; }

%pull-span-all       { margin-left: -(percentage(1/1) - toast-alpha-margin() ); }

%pull-one-half       { margin-left: -(percentage(1/2) - toast-alpha-margin() ); }

%pull-one-third      { margin-left: -(percentage(1/3) - toast-alpha-margin() ); }
%pull-two-thirds     { margin-left: -(percentage(2/3) - toast-alpha-margin() ); }

%pull-one-quarter    { margin-left: -(percentage(1/4) - toast-alpha-margin() ); }
%pull-two-quarters   { margin-left: -(percentage(2/4) - toast-alpha-margin() ); }
%pull-three-quarters { margin-left: -(percentage(3/4) - toast-alpha-margin() ); }

// For each of our column groups...
@each $group in $toast-col-groups {

  // For each column width from 1 to the column group...
  @for $i from 1 through $group {
    .#{$toast-grid-column-namespace}--#{$i}-of-#{$group} {
      @if percentage($i/$group) == percentage(1/1) {
        @extend %span-all;
      } @else if percentage($i/$group) == percentage(1/2) {
        @extend %one-half;
      } @else if percentage($i/$group) == percentage(1/3) {
        @extend %one-third;
      } @else if percentage($i/$group) == percentage(2/3) {
        @extend %two-thirds;
      } @else if percentage($i/$group) == percentage(1/4) {
        @extend %one-quarter;
      } @else if percentage($i/$group) == percentage(2/4) {
        @extend %two-quarters;
      } @else if percentage($i/$group) == percentage(3/4) {
        @extend %three-quarters;
      } @else {

        width: percentage($i/$group) - 2*toast-alpha-margin() ;

      }
    }

    @if ($toast-pushes) {
      .#{$toast-grid-column-namespace}--push-#{$i}-of-#{$group} {
        @if percentage($i/$group) == percentage(1/1) {
          @extend %push-span-all;
        } @else if percentage($i/$group) == percentage(1/2) {
          @extend %push-one-half;
        } @else if percentage($i/$group) == percentage(1/3) {
          @extend %push-one-third;
        } @else if percentage($i/$group) == percentage(2/3) {
          @extend %push-two-thirds;
        } @else if percentage($i/$group) == percentage(1/4) {
          @extend %push-one-quarter;
        } @else if percentage($i/$group) == percentage(2/4) {
          @extend %push-two-quarters;
        } @else if percentage($i/$group) == percentage(3/4) {
          @extend %push-three-quarters;
        } @else {

          margin-left: percentage($i/$group);

        }
      }
    } // end pushes

    @if ($toast-pulls) {
      .#{$toast-grid-column-namespace}--pull-#{$i}-of-#{$group} {

        @if percentage($i/$group) == percentage(1/1) {
          @extend %pull-span-all;
        } @else if percentage($i/$group) == percentage(1/2) {
          @extend %pull-one-half;
        } @else if percentage($i/$group) == percentage(1/3) {
          @extend %pull-one-third;
        } @else if percentage($i/$group) == percentage(2/3) {
          @extend %pull-two-thirds;
        } @else if percentage($i/$group) == percentage(1/4) {
          @extend %pull-one-quarter;
        } @else if percentage($i/$group) == percentage(2/4) {
          @extend %pull-two-quarters;
        } @else if percentage($i/$group) == percentage(3/4) {
          @extend %pull-three-quarters;
        } @else {

          margin-left: -(percentage($i/$group));

        }
      }
    } // end pulls
  } // end @for

} // end @each

// All direct descendents of .grid get treated the same way.
// This might be overkill for some, but it's a time-saver for me.
.#{$toast-grid-column-namespace} {
  box-sizing: border-box;
  display: inline-block;
  margin-right: toast-alpha-margin(3/10) ;
  margin-left: toast-alpha-margin(3/10) ;
  min-height: 1px;
  vertical-align: top;

  @media (min-width: $toast-breakpoint-big) {

    margin-right: toast-alpha-margin(2/10) ;
    margin-left: toast-alpha-margin(2/10) ;
  }
  @media (max-width: $toast-breakpoint-medium) {
    
    margin-right: toast-alpha-margin(4/10) ;
    margin-left: toast-alpha-margin(4/10) ;
  }
  @media (max-width: $toast-breakpoint-small) {
    
    margin-right: toast-alpha-margin(6/10) ;
    margin-left: toast-alpha-margin(6/10) ;
  } 
  @media (max-width: $toast-breakpoint-smaller) {
    
    margin-right: toast-alpha-margin(9/10) ;
    margin-left: toast-alpha-margin(9/10) ;
  }
  @media (max-width: $toast-breakpoint-min) {
    
    margin-right: toast-alpha-margin(9/10) ;
    margin-left: toast-alpha-margin(10/10) ;
  }
}

// Centers the column in the grid and clears the row of all other columns
.#{$toast-grid-column-namespace}--centered {
  
  display: block;
  margin-left: auto;
  margin-right: auto;
}


// Displays the column as the first in its row
.#{$toast-grid-column-namespace}--d-first {
  
  float: left;
}

// Displays the column as the last in its row
.#{$toast-grid-column-namespace}--d-last {
  
  float: right;
}

// Removes gutters from the columns
.#{$toast-grid-namespace}--no-gutter {
  
  margin: 0;
  width: 100%;

  .#{$toast-grid-column-namespace}--span-all {
    
    margin: 0;
    width: 100%;
  }
}

// Align column to the bottom.
.#{$toast-grid-column-namespace}--ab {
  
  vertical-align: bottom;
}

// Align column to the middle.
.#{$toast-grid-column-namespace}--am {
  
  vertical-align: middle;
}
